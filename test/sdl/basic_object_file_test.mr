private import "../../sdl/manta-lib/mantaray.mr"

material_library library()

simple_bsdf_material(
    name: "Backdrop",
    library: library,
    bsdf: lambertian_bsdf()
)

simple_bsdf_material(
    name: "PenBody",
    library: library,
    bsdf: bilayer_bsdf(
        coating: phong_distribution(16.0),
        diffuse: vector(0.5, 0.0, 0.0),
        specular: vector(0.01, 0.01, 0.01)
    )
)

obj_file obj(
    filename: "../../demos/models/cube.obj",
    materials: library
)

kd_tree tree(
    mesh: obj
)

scene main_scene()

scene_object main_object(
    name: "Main",
    scene: main_scene,
    geometry: tree,
    default_material: 
        simple_bsdf_material(
            name: "Lambert",
            library: library,
            bsdf: lambertian_bsdf()
        )
)

standard_camera camera(
    up: vector(-0.220393, 0.934556, 0.112196),
    position: vector(11.24, 3.33763, -5.722),
    direction: vector(-0.861515, -0.25582, 0.438575),
    resolution_x: 1920,
    resolution_y: 1080,
    plane_height: 0.3,
    plane_distance: 1.0,
    samples: 100,
    sampler: random_sampler()
)

ray_tracer mr(
    scene: main_scene,
    camera: camera,
    materials: library,
    background: vector(1.0, 1.0, 1.0)
)

image_output(
    map: mr.image,
    filename: "test.jpg"
)
